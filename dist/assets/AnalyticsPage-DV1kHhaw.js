import{c as Oe,r as l,R as Y,j as n}from"./index-skxUcrdA.js";import{H as Ie}from"./Header-CQ0SdTY2.js";import{u as De}from"./riskStore-CjCmUl5B.js";import{g as Le,A as Ce,D as Re,R as Te}from"./RiskMap-BdetkTFl.js";import{U as _e,T as ze,B as We}from"./users-ByPugwAb.js";import{x as z,I as U,Q as Be,ag as Ke,G as I,ah as $e,ai as Fe,aj as Ye,ak as Me,al as He,am as Ve,d as Ge,an as K,ao as Ue,ap as ae,aq as Xe,e as X,h as he,k as pe,l as me,ar as Ze,n as qe,a6 as Je,m as re,w as Qe,D as et,y as Z,R as tt,S as at,z as rt,A as fe,B as nt,C as it,a8 as lt,E as st,a9 as ot,Z as ct,L as dt,J as ut,H as xe,aa as ne,a as ie,T as ht,U as pt,V as T,W as mt,X as ft,ac as xt,Y as vt,as as g,at as gt,au as yt,av as bt,f as jt,aw as wt,ax as Pt,ay as St,az as Nt,aA as At,aB as kt,a1 as Et,a2 as Ot,a3 as le,a4 as It}from"./CartesianChart-BilDmmaS.js";import{f as Dt,a as Lt,S as Ct,g as Rt,h as M,i as Tt,P as _t,e as zt,C as Wt,d as Bt,X as Kt}from"./PieChart-DCgodwAZ.js";import{r as $t}from"./index-ZG1ucnfu.js";import"./leaflet-CKEkqWzA.js";const Ft=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Yt=Oe("map",Ft);function B(){return B=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)({}).hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},B.apply(null,arguments)}function se(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),a.push.apply(a,r)}return a}function Mt(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?se(Object(a),!0).forEach(function(r){Ht(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):se(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function Ht(t,e,a){return(e=Vt(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function Vt(t){var e=Gt(t,"string");return typeof e=="symbol"?e:e+""}function Gt(t,e){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var P=32,Ut={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function Xt(t){var{data:e,iconType:a,inactiveColor:r}=t,i=P/2,s=P/6,c=P/3,d=e.inactive?r:e.color,o=a??e.type;if(o==="none")return null;if(o==="plainline"){var u;return l.createElement("line",{strokeWidth:4,fill:"none",stroke:d,strokeDasharray:(u=e.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:i,x2:P,y2:i,className:"recharts-legend-icon"})}if(o==="line")return l.createElement("path",{strokeWidth:4,fill:"none",stroke:d,d:"M0,".concat(i,"h").concat(c,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*c,",").concat(i,`
            H`).concat(P,"M").concat(2*c,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(c,",").concat(i),className:"recharts-legend-icon"});if(o==="rect")return l.createElement("path",{stroke:"none",fill:d,d:"M0,".concat(P/8,"h").concat(P,"v").concat(P*3/4,"h").concat(-P,"z"),className:"recharts-legend-icon"});if(l.isValidElement(e.legendIcon)){var h=Mt({},e);return delete h.legendIcon,l.cloneElement(e.legendIcon,h)}return l.createElement(Dt,{fill:d,cx:i,cy:i,size:P,sizeType:"diameter",type:o})}function Zt(t){var{payload:e,iconSize:a,layout:r,formatter:i,inactiveColor:s,iconType:c}=t,d={x:0,y:0,width:P,height:P},o={display:r==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((h,m)=>{var f=h.formatter||i,v=U({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:h.inactive});if(h.type==="none")return null;var x=h.inactive?s:h.color,p=f?f(h.value,h,m):h.value;return l.createElement("li",B({className:v,style:o,key:"legend-item-".concat(m)},Be(t,h,m)),l.createElement(Ke,{width:a,height:a,viewBox:d,style:u,"aria-label":"".concat(p," legend icon")},l.createElement(Xt,{data:h,iconType:c,inactiveColor:s})),l.createElement("span",{className:"recharts-legend-item-text",style:{color:x}},p))})}var qt=t=>{var e=z(t,Ut),{payload:a,layout:r,align:i}=e;if(!a||!a.length)return null;var s={padding:0,margin:0,textAlign:r==="horizontal"?i:"left"};return l.createElement("ul",{className:"recharts-default-legend",style:s},l.createElement(Zt,B({},e,{payload:a})))};function Jt(){return I($e)}var Qt=["contextPayload"];function H(){return H=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)({}).hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},H.apply(null,arguments)}function oe(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),a.push.apply(a,r)}return a}function C(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?oe(Object(a),!0).forEach(function(r){ea(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):oe(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function ea(t,e,a){return(e=ta(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function ta(t){var e=aa(t,"string");return typeof e=="symbol"?e:e+""}function aa(t,e){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ra(t,e){if(t==null)return{};var a,r,i=na(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)a=s[r],e.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(i[a]=t[a])}return i}function na(t,e){if(t==null)return{};var a={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;a[r]=t[r]}return a}function ia(t){return t.value}function la(t){var{contextPayload:e}=t,a=ra(t,Qt),r=Xe(e,t.payloadUniqBy,ia),i=C(C({},a),{},{payload:r});return l.isValidElement(t.content)?l.cloneElement(t.content,i):typeof t.content=="function"?l.createElement(t.content,i):l.createElement(qt,i)}function sa(t,e,a,r,i,s){var{layout:c,align:d,verticalAlign:o}=e,u,h;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(d==="center"&&c==="vertical"?u={left:((r||0)-s.width)/2}:u=d==="right"?{right:a&&a.right||0}:{left:a&&a.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(o==="middle"?h={top:((i||0)-s.height)/2}:h=o==="bottom"?{bottom:a&&a.bottom||0}:{top:a&&a.top||0}),C(C({},u),h)}function oa(t){var e=K();return l.useEffect(()=>{e(Ue(t))},[e,t]),null}function ca(t){var e=K();return l.useEffect(()=>(e(ae(t)),()=>{e(ae({width:0,height:0}))}),[e,t]),null}function da(t,e,a,r){return t==="vertical"&&Ge(e)?{height:e}:t==="horizontal"?{width:a||r}:null}var ua={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function ve(t){var e=z(t,ua),a=Jt(),r=Fe(),i=Ye(),{width:s,height:c,wrapperStyle:d,portal:o}=e,[u,h]=Me([a]),m=He(),f=Ve();if(m==null||f==null)return null;var v=m-(i?.left||0)-(i?.right||0),x=da(e.layout,c,s,v),p=o?d:C(C({position:"absolute",width:x?.width||s||"auto",height:x?.height||c||"auto"},sa(d,e,i,m,f,u)),d),y=o??r;if(y==null||a==null)return null;var S=l.createElement("div",{className:"recharts-legend-wrapper",style:p,ref:h},l.createElement(oa,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),!o&&l.createElement(ca,{width:u.width,height:u.height}),l.createElement(la,H({},e,x,{margin:i,chartWidth:m,chartHeight:f,contextPayload:a})));return $t.createPortal(S,y)}ve.displayName="Legend";var ge=(t,e,a,r)=>pe(t,"xAxis",e,r),ye=(t,e,a,r)=>me(t,"xAxis",e,r),be=(t,e,a,r)=>pe(t,"yAxis",a,r),je=(t,e,a,r)=>me(t,"yAxis",a,r),ha=X([he,ge,be,ye,je],(t,e,a,r,i)=>Je(t,"xAxis")?re(e,r,!1):re(a,i,!1)),pa=(t,e,a,r,i)=>i;function ma(t){return t.type==="line"}var fa=X([qe,pa],(t,e)=>t.filter(ma).find(a=>a.id===e)),xa=X([he,ge,be,ye,je,fa,ha,Ze],(t,e,a,r,i,s,c,d)=>{var{chartData:o,dataStartIndex:u,dataEndIndex:h}=d;if(!(s==null||e==null||a==null||r==null||i==null||r.length===0||i.length===0||c==null||t!=="horizontal"&&t!=="vertical")){var{dataKey:m,data:f}=s,v;if(f!=null&&f.length>0?v=f:v=o?.slice(u,h+1),v!=null)return _a({layout:t,xAxis:e,yAxis:a,xAxisTicks:r,yAxisTicks:i,dataKey:m,bandSize:c,displayedData:v})}}),va=["id"],ga=["type","layout","connectNulls","needClip","shape"],ya=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function _(){return _=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)({}).hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},_.apply(null,arguments)}function ce(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),a.push.apply(a,r)}return a}function A(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?ce(Object(a),!0).forEach(function(r){ba(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ce(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function ba(t,e,a){return(e=ja(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function ja(t){var e=wa(t,"string");return typeof e=="symbol"?e:e+""}function wa(t,e){if(typeof t!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q(t,e){if(t==null)return{};var a,r,i=Pa(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)a=s[r],e.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(i[a]=t[a])}return i}function Pa(t,e){if(t==null)return{};var a={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;a[r]=t[r]}return a}var Sa=t=>{var{dataKey:e,name:a,stroke:r,legendType:i,hide:s}=t;return[{inactive:s,dataKey:e,type:i,color:r,value:fe(a,e),payload:t}]},Na=l.memo(t=>{var{dataKey:e,data:a,stroke:r,strokeWidth:i,fill:s,name:c,hide:d,unit:o,tooltipType:u,id:h}=t,m={dataDefinedOnItem:a,positions:void 0,settings:{stroke:r,strokeWidth:i,fill:s,dataKey:e,nameKey:void 0,name:fe(c,e),hide:d,type:u,color:r,unit:o,graphicalItemId:h}};return l.createElement(nt,{tooltipEntrySettings:m})}),we=(t,e)=>"".concat(e,"px ").concat(t-e,"px");function Aa(t,e){for(var a=t.length%2!==0?[...t,0]:t,r=[],i=0;i<e;++i)r=[...r,...a];return r}var ka=(t,e,a)=>{var r=a.reduce((m,f)=>m+f);if(!r)return we(e,t);for(var i=Math.floor(t/r),s=t%r,c=e-t,d=[],o=0,u=0;o<a.length;u+=a[o],++o)if(u+a[o]>s){d=[...a.slice(0,o),s-u];break}var h=d.length%2===0?[0,c]:[c];return[...Aa(a,i),...d,...h].map(m=>"".concat(m,"px")).join(", ")};function Ea(t){var{clipPathId:e,points:a,props:r}=t,{dot:i,dataKey:s,needClip:c}=r,{id:d}=r,o=q(r,va),u=vt(o);return l.createElement(Re,{points:a,dot:i,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:u,needClip:c,clipPathId:e})}function Oa(t){var{showLabels:e,children:a,points:r}=t,i=l.useMemo(()=>r?.map(s=>{var c,d,o={x:(c=s.x)!==null&&c!==void 0?c:0,y:(d=s.y)!==null&&d!==void 0?d:0,width:0,lowerWidth:0,upperWidth:0,height:0};return A(A({},o),{},{value:s.value,payload:s.payload,viewBox:o,parentViewBox:void 0,fill:void 0})}),[r]);return l.createElement(ft,{value:e?i:void 0},a)}function de(t){var{clipPathId:e,pathRef:a,points:r,strokeDasharray:i,props:s}=t,{type:c,layout:d,connectNulls:o,needClip:u,shape:h}=s,m=q(s,ga),f=A(A({},xt(m)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(e,")"):void 0,points:r,type:c,layout:d,connectNulls:o,strokeDasharray:i??s.strokeDasharray});return l.createElement(l.Fragment,null,r?.length>1&&l.createElement(Ct,_({shapeType:"curve",option:h},f,{pathRef:a})),l.createElement(Ea,{points:r,clipPathId:e,props:s}))}function Ia(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function Da(t){var{clipPathId:e,props:a,pathRef:r,previousPointsRef:i,longestAnimatedLengthRef:s}=t,{points:c,strokeDasharray:d,isAnimationActive:o,animationBegin:u,animationDuration:h,animationEasing:m,animateNewValues:f,width:v,height:x,onAnimationEnd:p,onAnimationStart:y}=a,S=i.current,j=ht(c,"recharts-line-"),w=l.useRef(j),[D,k]=l.useState(!1),b=!D,L=l.useCallback(()=>{typeof p=="function"&&p(),k(!1)},[p]),$=l.useCallback(()=>{typeof y=="function"&&y(),k(!0)},[y]),E=Ia(r.current),W=l.useRef(0);w.current!==j&&(W.current=s.current,w.current=j);var J=W.current;return l.createElement(Oa,{points:c,showLabels:b},a.children,l.createElement(pt,{animationId:j,begin:u,duration:h,isActive:o,easing:m,onAnimationEnd:L,onAnimationStart:$,key:j},O=>{var Ne=T(J,E+J,O),F=Math.min(Ne,E),R;if(o)if(d){var Ae="".concat(d).split(/[,\s]+/gim).map(N=>parseFloat(N));R=ka(F,E,Ae)}else R=we(E,F);else R=d==null?void 0:String(d);if(O>0&&E>0&&(i.current=c,s.current=Math.max(s.current,F)),S){var ke=S.length/c.length,Q=O===1?c:c.map((N,Ee)=>{var ee=Math.floor(Ee*ke);if(S[ee]){var te=S[ee];return A(A({},N),{},{x:T(te.x,N.x,O),y:T(te.y,N.y,O)})}return f?A(A({},N),{},{x:T(v*2,N.x,O),y:T(x/2,N.y,O)}):A(A({},N),{},{x:N.x,y:N.y})});return i.current=Q,l.createElement(de,{props:a,points:Q,clipPathId:e,pathRef:r,strokeDasharray:R})}return l.createElement(de,{props:a,points:c,clipPathId:e,pathRef:r,strokeDasharray:R})}),l.createElement(mt,{label:a.label}))}function La(t){var{clipPathId:e,props:a}=t,r=l.useRef(null),i=l.useRef(0),s=l.useRef(null);return l.createElement(Da,{props:a,clipPathId:e,previousPointsRef:r,longestAnimatedLengthRef:i,pathRef:s})}var Ca=(t,e)=>{var a,r;return{x:(a=t.x)!==null&&a!==void 0?a:void 0,y:(r=t.y)!==null&&r!==void 0?r:void 0,value:t.value,errorVal:xe(t.payload,e)}};class Ra extends l.Component{render(){var{hide:e,dot:a,points:r,className:i,xAxisId:s,yAxisId:c,top:d,left:o,width:u,height:h,id:m,needClip:f,zIndex:v}=this.props;if(e)return null;var x=U("recharts-line",i),p=m,{r:y,strokeWidth:S}=Le(a),j=ot(a),w=y*2+S,D=f?"url(#clipPath-".concat(j?"":"dots-").concat(p,")"):void 0;return l.createElement(ct,{zIndex:v},l.createElement(dt,{className:x},f&&l.createElement("defs",null,l.createElement(ut,{clipPathId:p,xAxisId:s,yAxisId:c}),!j&&l.createElement("clipPath",{id:"clipPath-dots-".concat(p)},l.createElement("rect",{x:o-w/2,y:d-w/2,width:u+w,height:h+w}))),l.createElement(Lt,{xAxisId:s,yAxisId:c,data:r,dataPointFormatter:Ca,errorBarOffset:0},l.createElement(La,{props:this.props,clipPathId:p}))),l.createElement(Ce,{activeDot:this.props.activeDot,points:r,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:D}))}}var Pe={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:et.line,type:"linear"};function Ta(t){var e=z(t,Pe),{activeDot:a,animateNewValues:r,animationBegin:i,animationDuration:s,animationEasing:c,connectNulls:d,dot:o,hide:u,isAnimationActive:h,label:m,legendType:f,xAxisId:v,yAxisId:x,id:p}=e,y=q(e,ya),{needClip:S}=it(v,x),j=lt(),w=st(),D=Z(),k=I(W=>xa(W,v,x,D,p));if(w!=="horizontal"&&w!=="vertical"||k==null||j==null)return null;var{height:b,width:L,x:$,y:E}=j;return l.createElement(Ra,_({},y,{id:p,connectNulls:d,dot:o,activeDot:a,animateNewValues:r,animationBegin:i,animationDuration:s,animationEasing:c,isAnimationActive:h,hide:u,label:m,legendType:f,xAxisId:v,yAxisId:x,points:k,layout:w,height:b,width:L,left:$,top:E,needClip:S}))}function _a(t){var{layout:e,xAxis:a,yAxis:r,xAxisTicks:i,yAxisTicks:s,dataKey:c,bandSize:d,displayedData:o}=t;return o.map((u,h)=>{var m=xe(u,c);if(e==="horizontal"){var f=ne({axis:a,ticks:i,bandSize:d,entry:u,index:h}),v=ie(m)?null:r.scale(m);return{x:f,y:v,value:m,payload:u}}var x=ie(m)?null:a.scale(m),p=ne({axis:r,ticks:s,bandSize:d,entry:u,index:h});return x==null||p==null?null:{x,y:p,value:m,payload:u}}).filter(Boolean)}function za(t){var e=z(t,Pe),a=Z();return l.createElement(tt,{id:e.id,type:"line"},r=>l.createElement(l.Fragment,null,l.createElement(at,{legendPayload:Sa(e)}),l.createElement(Na,{dataKey:e.dataKey,data:e.data,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,unit:e.unit,tooltipType:e.tooltipType,id:r}),l.createElement(rt,{type:"line",id:r,data:e.data,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,hide:e.hide,isPanorama:a}),l.createElement(Ta,_({},e,{id:r}))))}var V=l.memo(za,Qe);V.displayName="Line";var Wa=["dangerouslySetInnerHTML","ticks","scale"],Ba=["id","scale"];function G(){return G=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)({}).hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},G.apply(null,arguments)}function ue(t,e){if(t==null)return{};var a,r,i=Ka(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)a=s[r],e.indexOf(a)===-1&&{}.propertyIsEnumerable.call(t,a)&&(i[a]=t[a])}return i}function Ka(t,e){if(t==null)return{};var a={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;a[r]=t[r]}return a}function $a(t){var e=K(),a=l.useRef(null);return l.useLayoutEffect(()=>{a.current===null?e(gt(t)):a.current!==t&&e(yt({prev:a.current,next:t})),a.current=t},[t,e]),l.useLayoutEffect(()=>()=>{a.current&&(e(bt(a.current)),a.current=null)},[e]),null}var Fa=t=>{var{yAxisId:e,className:a,width:r,label:i}=t,s=l.useRef(null),c=l.useRef(null),d=I(jt),o=Z(),u=K(),h="yAxis",m=I(b=>wt(b,e)),f=I(b=>Pt(b,e)),v=I(b=>St(b,h,e,o)),x=I(b=>Nt(b,e));if(l.useLayoutEffect(()=>{if(!(r!=="auto"||!m||At(i)||l.isValidElement(i)||x==null)){var b=s.current;if(b){var L=b.getCalculatedWidth();Math.round(m.width)!==Math.round(L)&&u(kt({id:e,width:L}))}}},[v,m,u,i,e,r,x]),m==null||f==null||x==null)return null;var{dangerouslySetInnerHTML:p,ticks:y,scale:S}=t,j=ue(t,Wa),{id:w,scale:D}=x,k=ue(x,Ba);return l.createElement(Tt,G({},j,k,{ref:s,labelRef:c,x:f.x,y:f.y,tickTextProps:r==="auto"?{width:void 0}:{width:r},width:m.width,height:m.height,className:U("recharts-".concat(h," ").concat(h),a),viewBox:d,ticks:v,axisType:h}))},Ya={allowDataOverflow:g.allowDataOverflow,allowDecimals:g.allowDecimals,allowDuplicatedCategory:g.allowDuplicatedCategory,angle:g.angle,axisLine:M.axisLine,hide:!1,includeHidden:g.includeHidden,interval:g.interval,minTickGap:g.minTickGap,mirror:g.mirror,orientation:g.orientation,padding:g.padding,reversed:g.reversed,scale:g.scale,tick:g.tick,tickCount:g.tickCount,tickLine:M.tickLine,tickSize:M.tickSize,type:g.type,width:g.width,yAxisId:0},Ma=t=>{var e=z(t,Ya);return l.createElement(l.Fragment,null,l.createElement($a,{interval:e.interval,id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:e.includeHidden,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:e.angle,minTickGap:e.minTickGap,tick:e.tick,tickFormatter:e.tickFormatter}),l.createElement(Fa,e))},Se=l.memo(Ma,Rt);Se.displayName="YAxis";var Ha=["axis"],Va=l.forwardRef((t,e)=>l.createElement(Et,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Ha,tooltipPayloadSearcher:Ot,categoricalChartProps:t,ref:e}));const ar=()=>{const{selectedScenario:t,selectedYear:e,setScenario:a,setYear:r,dashboardData:i,populationData:s,initialize:c}=De();l.useEffect(()=>{c()},[c]);const[d,o]=Y.useState([]),[u,h]=Y.useState([]),[m,f]=Y.useState(!1);l.useEffect(()=>{(async()=>(f(!0),o([]),h([]),f(!1)))()},[t]);const v=s?.qisms.map((p,y)=>({rank:y+1,name:p.name,pop:p.exposedPopulation.toLocaleString(),risk:p.riskLevel==="شديد"?"high":p.riskLevel==="متوسط"?"med":"low",vy:p.riskLevel}))||[],x=["2030","2050","2070","2100"];return n.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans",dir:"rtl",children:[n.jsx(Ie,{active:"analytics"}),n.jsxs("main",{className:"container mx-auto px-6 py-8",children:[n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 animate-slide-up",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"تحليل ضعف السكان"}),n.jsx("p",{className:"text-gray-500 text-sm",children:"تصور تأثيرات ارتفاع مستوى سطح البحر (SLR) على توزيع السكان تحت سيناريوهات IPCC SSP."})]}),n.jsxs("div",{className:"bg-white p-2 rounded-xl shadow-sm border border-gray-200 flex items-center gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-xs font-bold text-gray-500 block mb-1",children:"سيناريو SSP"}),n.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[n.jsx("button",{onClick:()=>a("SSP126"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${t==="SSP126"?"bg-green-600 text-white shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"SSP1-2.6"}),n.jsx("button",{onClick:()=>a("SSP245"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${t==="SSP245"?"bg-yellow-500 text-white shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"SSP2-4.5"}),n.jsx("button",{onClick:()=>a("SSP585"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${t==="SSP585"?"bg-red-600 text-white shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"SSP5-8.5"})]})]}),n.jsxs("div",{className:"flex-1 w-48 px-2",children:[n.jsxs("div",{className:"flex justify-between items-center mb-1",children:[n.jsx("label",{className:"text-xs font-bold text-gray-500",children:"عام التوقعات"}),n.jsx("span",{className:"text-blue-600 font-bold text-sm",children:e})]}),n.jsx("input",{type:"range",min:"0",max:"3",step:"1",value:x.indexOf(e),onChange:p=>r(x[parseInt(p.target.value)]),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 h-full animate-slide-up delay-100",children:[n.jsxs("div",{className:"lg:col-span-8 bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden relative min-h-[500px]",children:[n.jsx("div",{className:"absolute inset-0 z-0",children:n.jsx(Te,{className:"h-full rounded-none border-0"})}),n.jsxs("div",{className:"absolute bottom-6 right-6 bg-white/95 backdrop-blur shadow-lg rounded-xl p-4 max-w-xs border border-gray-100",children:[n.jsxs("h3",{className:"font-bold text-sm text-gray-800 mb-2",children:["حالة الخطر الحالية (",e,")"]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{className:"text-gray-500",children:"السيناريو"}),n.jsx("span",{className:"font-bold",children:t})]}),n.jsxs("div",{className:"flex justify-between text-xs",children:[n.jsx("span",{className:"text-gray-500",children:"المناطق المهددة"}),n.jsxs("span",{className:"font-bold text-red-600",children:[i?.highRiskAreas.length||0," مناطق"]})]})]}),n.jsx("div",{className:"mt-3",children:n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-1",children:[n.jsx("span",{children:"منخفض"}),n.jsx("div",{className:"h-2 w-full rounded-full bg-gradient-to-r from-green-400 via-yellow-400 to-red-500"}),n.jsx("span",{children:"مرتفع"})]})})]}),n.jsxs("div",{className:"absolute top-6 left-6 flex flex-col gap-2",children:[n.jsx("button",{className:"w-8 h-8 bg-white rounded-lg shadow-md border border-gray-100 flex items-center justify-center hover:bg-gray-50 text-gray-600 transition-colors",children:"+"}),n.jsx("button",{className:"w-8 h-8 bg-white rounded-lg shadow-md border border-gray-100 flex items-center justify-center hover:bg-gray-50 text-gray-600 transition-colors",children:"-"}),n.jsx("button",{className:"w-8 h-8 bg-white rounded-lg shadow-md border border-gray-100 flex items-center justify-center hover:bg-gray-50 text-gray-600 transition-colors",children:n.jsx(Yt,{className:"w-4 h-4"})})]})]}),n.jsxs("div",{className:"lg:col-span-4 flex flex-col gap-6",children:[n.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200 relative overflow-hidden group hover:border-blue-500/30 transition-all",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500 text-xs font-bold uppercase mb-1",children:"إجمالي السكان المعرضين للخطر"}),n.jsx("h3",{className:"text-4xl font-extrabold text-gray-900 mb-2",children:i?.populationAtRisk.toLocaleString()||"--"}),n.jsx("span",{className:"bg-red-50 text-red-600 text-xs font-bold px-2 py-1 rounded flex items-center w-fit gap-1",children:"متزايد سنوياً ↗"})]}),n.jsx("div",{className:"bg-blue-50 p-3 rounded-xl text-blue-600 group-hover:bg-blue-600 group-hover:text-white transition-colors",children:n.jsx(_e,{className:"w-6 h-6"})})]})}),n.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200 group hover:border-yellow-500/30 transition-all",children:n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500 text-xs font-bold uppercase mb-1",children:"المساحة المغمورة (كم²)"}),n.jsx("h3",{className:"text-4xl font-extrabold text-gray-900 mb-2",children:i?.floodedAreaKm2||"--"}),n.jsxs("span",{className:"bg-yellow-50 text-yellow-700 text-xs font-bold px-2 py-1 rounded flex items-center w-fit gap-1",children:[n.jsx(ze,{className:"w-3 h-3"}),"مؤشر خطير"]})]}),n.jsx("div",{className:"bg-yellow-50 p-3 rounded-xl text-yellow-600 group-hover:bg-yellow-500 group-hover:text-white transition-colors",children:n.jsx(We,{className:"w-6 h-6"})})]})}),n.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200 flex-1 flex flex-col",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"ضعف الإسكان"}),n.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:"•••"})]}),n.jsx("div",{className:"flex-1 min-h-[180px] relative flex justify-center items-center",children:d.length>0?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[n.jsx("span",{className:"text-3xl font-extrabold text-gray-900",children:"65%"}),n.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"عشوائي"})]}),n.jsx(le,{width:"100%",height:"100%",children:n.jsx(_t,{children:n.jsx(zt,{data:d,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:d.map((p,y)=>n.jsx(Wt,{fill:p.color},`cell-${y}`))})})})]}):n.jsx("div",{className:"text-gray-400 text-sm",children:"لا توجد بيانات (بانتظار الربط)"})})]})]}),n.jsxs("div",{className:"lg:col-span-12 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200",children:[n.jsx("div",{className:"flex justify-between items-center mb-6",children:n.jsx("h3",{className:"font-bold text-gray-800",children:"التعرض حسب السيناريو (2030-2100)"})}),n.jsx("div",{className:"h-64",children:n.jsx(le,{width:"100%",height:"100%",children:u.length>0?n.jsxs(Va,{data:u,children:[n.jsx(Bt,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),n.jsx(Kt,{dataKey:"year",axisLine:!1,tickLine:!1,tick:{fill:"#6b7280",fontSize:12}}),n.jsx(Se,{axisLine:!1,tickLine:!1,tick:{fill:"#6b7280",fontSize:12}}),n.jsx(It,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),n.jsx(ve,{}),n.jsx(V,{type:"monotone",dataKey:"ssp1",stroke:"#2563eb",strokeWidth:3,dot:{fill:"#2563eb",r:4},name:"SSP1-2.6"}),n.jsx(V,{type:"monotone",dataKey:"ssp5",stroke:"#ef4444",strokeWidth:3,dot:{fill:"#ef4444",r:4},name:"SSP5-8.5"})]}):n.jsx("div",{className:"h-full flex items-center justify-center text-gray-400 text-sm",children:"لا توجد بيانات تاريخية متاحة"})})})]}),n.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"تصنيف الأحياء (تأثر الأقسام)"}),n.jsx("button",{className:"text-blue-600 text-xs font-bold hover:underline",children:"تصدير CSV"})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full text-right",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-gray-100",children:[n.jsx("th",{className:"pb-3 text-xs font-bold text-gray-500",children:"الترتيب"}),n.jsx("th",{className:"pb-3 text-xs font-bold text-gray-500",children:"اسم القسم"}),n.jsx("th",{className:"pb-3 text-xs font-bold text-gray-500",children:"السكان المتأثرين"}),n.jsx("th",{className:"pb-3 text-xs font-bold text-gray-500",children:"مؤشر الضعف"})]})}),n.jsx("tbody",{className:"text-sm",children:v.length>0?v.map(p=>n.jsxs("tr",{className:"border-b border-gray-50 hover:bg-gray-50 transition-colors",children:[n.jsx("td",{className:"py-3 font-bold text-gray-900",children:p.rank}),n.jsx("td",{className:"py-3 text-gray-700",children:p.name}),n.jsx("td",{className:"py-3 font-mono font-bold",children:p.pop}),n.jsx("td",{className:"py-3",children:n.jsxs("span",{className:`px-2 py-1 rounded text-xs font-bold ${p.risk==="high"?"bg-red-50 text-red-600":p.risk==="med"?"bg-orange-50 text-orange-600":"bg-green-50 text-green-600"}`,children:[p.risk==="high"?"عالي":p.risk==="med"?"متوسط":"منخفض"," ","(",p.vy,")"]})})]},p.rank)):n.jsx("tr",{children:n.jsx("td",{colSpan:4,className:"text-center py-4 text-gray-500",children:"جاري تحميل البيانات..."})})})]})})]})]})]})]})]})};export{ar as default};
